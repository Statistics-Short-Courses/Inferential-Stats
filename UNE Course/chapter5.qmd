---
title: "Paired t-test and ANOVA"
---

# **Hypothesis tests using the t-distribution**

![](images/clipboard-312548449.png)

# Paired t-test

The next data set we will be using is the [Respiratory Disease hospitalisations](https://www.healthstats.nsw.gov.au/indicator?name=-res-cat-hos&location=NSW&view=Table&measure=DSTRate&confidence=true&groups=Period,Disease%20type,Sex,Remoteness%20category&compare=Disease%20type,Sex,Period,Remoteness%20category&filter=Sex,Males,Females&filter=Disease%20type,Asthma&filter=Period,01/02,05/06,07/08,06/07,02/03,18/19,04/05,09/10,20/21,19/20,03/04,16/17,17/18,08/09,15/16,10/11,11/12,12/13,13/14,14/15,21/22&filter=Remoteness%20category,NSW) dataset provided by HealthStats NSW. You will want to ensure that you only have "Asthma" under Disease Type and "Males" and "Females" under Sex, and "NSW" for Remoteness Category selected. You can then select the Download Icon in the bottom right corner of the graph, and then select "Download Data as CSV".

You can then save the file in your Datasets folder in your InferentialStats project folder that you created in the Introduction. You can give it a new name so that it is easier to call into R Studio.

If you open the file, you may notice that the first row is simply a title. We can ignore the title by including `skip` when we load in the data.

Once youâ€™ve saved the file, you can load the dataset into R by typing:

```{r, message = FALSE}
library(ggplot2) 
library(tidyverse)  
asthma <- read.csv("Data sets/respiratory_disease.csv", 
                   skip = 1) 
```

We can take a look at the data to ensure it has been loaded in correctly.

```{r}
str(asthma)
```

1.  How many categorical variables are there? `r fitb(4)`
2.  How many numerical variables are there? `r fitb(1)`
3.  How many observations are there? `r fitb(74)`

If you open the data set, you may notice there are "Sources", "Notes", and "Coding" underneath the dataset. This can be problematic when we try to analyse the data. To avoid this, we can take a "subset" of the data - in other words, we are dropping these unnecessary rows we don't need. We will also need to convert it to wide format to compare the paired data.

```{r}
clean_asthma <- subset(asthma, Sex %in% c("Males", "Females")) 

clean_asthma <- clean_asthma %>% 
  select(Period, Sex, Number) %>% 
  mutate(Number = as.numeric(gsub(",", "", Number))) %>%
  pivot_wider(names_from = Sex, values_from = Number)
```

```{r}

attach(clean_asthma)
```

### Write Hypotheses

The dataset includes the number of asthma hospitalisations for males and females for each year from 2001 to 2022. Although the data span a long period, we are not analysing trends over time in this task. Time needs to be handled carefully in statistics because consecutive years are usually correlated, which means they are not fully independent. However, each male value has a corresponding female value for the same year, so the two observations form a natural pair. This allows us to compare males and females within each year and then look at whether these yearly differences are consistently above or below zero across the 21-year period.

Because we are keeping the dataset simple, a natural research question is whether there is a difference in the average number of asthma hospitalisations between males and females across these paired yearly observations.

$H_0:$ On average, there is no difference in the number of asthma hospitalisations between males and females across the 21 years.

$H_A:$ On average, there is asignificant difference in the number of asthma hospitalisations between males and females across the 21 years.

We can express this in mathematical notation:

$H_0:$ $\mu_{diff}=0$

$H_A:$ $\mu_{diff} \neq 0$

What we need to calculate the difference between the hospitalisations for male and females. We can do that with:

```{r}
clean_asthma$diff <- (clean_asthma$Males - clean_asthma$Females)
clean_asthma$diff
```

We can check for skewness and normality.

```{r}
ggplot(data=clean_asthma, aes(y=diff, x=""))+
  geom_boxplot(fill="mistyrose", col="pink4")+
  theme_bw()
```

```{r}
ggplot(data=clean_asthma, aes(sample=diff))+
  geom_qq(col="navyblue")+
  geom_qq_line(col="steelblue")+
  labs(x="Theoretical quantiles", y="Sample quantiles")+
  theme_bw()
```

We can now run our t-test:

```{r}
t.test(Females, Males, paired = TRUE) 
```

The p-value ($t_{20}=0.85326, p=0.4036$) is greater than 0.05, so we fail to reject the null hypothesis. Therefore, there is no difference in mean hospitalisations for asthma between males and females.

With 95% confidence, there are between 104 fewer hospitalisations to 248 more hospitalisations in females compared to males. Because this interval includes zero, the data do not support a real difference between the sexes. **Note that if 0 was [NOT]{.underline} in the confidence interval, this would suggest a significant difference**.

# ANOVA
